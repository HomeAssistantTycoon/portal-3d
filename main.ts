namespace SpriteKind {
    export const screenThing = SpriteKind.create()
    export const bluePortal = SpriteKind.create()
    export const orangePortal = SpriteKind.create()
    export const energyPellet = SpriteKind.create()
    export const door = SpriteKind.create()
}
function FlagSystem () {
    FLAG1 = true
}
sprites.onOverlap(SpriteKind.energyPellet, SpriteKind.bluePortal, function (sprite, otherSprite) {
    if (pelletAllowed == true && orangePortalExists == true) {
        energyPellet2.x = orangePortal2.x + 0
        energyPellet2.y = orangePortal2.y + 0
        if (orangePortal2.x == bluePortal2.x) {
            energyPellet2.setVelocity(0, 0 - energyPellet2.vy)
        } else if (orangePortal2.y == bluePortal2.y) {
            energyPellet2.setVelocity(0 - energyPellet2.vx, 0)
        }
        if (orangePortal2.x == Min) {
            energyPellet2.setVelocity(100, 0)
        } else if (orangePortal2.x == Max) {
            energyPellet2.setVelocity(100, 0)
        } else if (orangePortal2.y == Min) {
            energyPellet2.setVelocity(0, 100)
        } else if (orangePortal2.y == Max) {
            energyPellet2.setVelocity(0, 100)
        } else if (newOrangePortalX > orangeSpawnX || newOrangePortalX < orangeSpawnX) {
            energyPellet2.setVelocity(0, 100)
        } else if (newOrangePortalY > orangeSpawnY || newOrangePortalY < orangeSpawnY) {
            energyPellet2.setVelocity(100, 0)
        }
    }
    pelletAllowed = false
    pause(100)
    pelletAllowed = true
})
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    shootingOrange = true
    orangPortalShot = sprites.createProjectileFromSprite(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . 5 5 5 5 5 5 5 . . . . 
        . . . . 5 4 4 4 4 4 4 4 5 . . . 
        . . . 5 4 4 4 4 4 4 4 4 4 5 . . 
        . . . 5 4 4 4 5 5 5 4 4 4 5 . . 
        . . . 5 4 4 5 5 4 5 5 4 4 5 . . 
        . . . 5 4 4 5 4 4 4 5 4 4 5 . . 
        . . . 5 4 4 5 5 4 5 5 4 4 5 . . 
        . . . 5 4 4 4 5 5 5 4 4 4 5 . . 
        . . . 5 4 4 4 4 4 4 4 4 4 5 . . 
        . . . . 5 4 4 4 4 4 4 4 5 . . . 
        . . . . . 5 5 5 5 5 5 5 . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, mySprite, Render.getAttribute(Render.attribute.dirX) * 100 + randint(-10, 10), Render.getAttribute(Render.attribute.dirY) * 100 + randint(-10, 10))
    orangPortalShot.setFlag(SpriteFlag.AutoDestroy, false)
    music.play(music.createSoundEffect(WaveShape.Sine, 1155, 1, 255, 0, 500, SoundExpressionEffect.Warble, InterpolationCurve.Linear), music.PlaybackMode.InBackground)
})
sprites.onOverlap(SpriteKind.orangePortal, SpriteKind.bluePortal, function (sprite, otherSprite) {
    if (lastShot == 1) {
        sprites.destroy(bluePortal2)
    } else {
        sprites.destroy(orangePortal2)
    }
    portal_allowed = false
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.orangePortal, function (sprite, otherSprite) {
    if (portal_allowed == true && blueportalexists == true) {
        lastPortal = 1
        if (bluePortal2.x == Min) {
            mySprite.x = bluePortal2.x + 10
            mySprite.y = bluePortal2.y + 0
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(0)
            } else {
                Render.setViewAngleInDegree(180)
            }
        } else if (bluePortal2.x == Max) {
            mySprite.x = bluePortal2.x + -10
            mySprite.y = bluePortal2.y + 0
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(180)
            } else {
                Render.setViewAngleInDegree(0)
            }
        } else if (bluePortal2.y == Min) {
            mySprite.x = bluePortal2.x + 0
            mySprite.y = bluePortal2.y + 10
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(90)
            } else {
                Render.setViewAngleInDegree(270)
            }
        } else if (bluePortal2.y == Max) {
            mySprite.x = bluePortal2.x + 0
            mySprite.y = bluePortal2.y + -11
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(270)
            } else {
                Render.setViewAngleInDegree(90)
            }
        } else if (newBluePortalX > blueSpawnX || newBluePortalX < blueSpawnX) {
            Ididsomethingbluex = true
            mySprite.x = bluePortal2.x + 0
            mySprite.y = bluePortal2.y + -11
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(270)
            } else {
                Render.setViewAngleInDegree(90)
            }
        } else if (newBluePortalY > blueSpwanY || newBluePortalY < blueSpwanY) {
            mySprite.x = bluePortal2.x + -10
            mySprite.y = bluePortal2.y + 0
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(180)
            } else {
                Render.setViewAngleInDegree(0)
            }
        }
    }
})
scene.onHitWall(SpriteKind.Player, function (sprite, location) {
    if (tiles.tileAtLocationEquals(location, assets.tile`myTile6`)) {
        tiles.setWallAt(location, false)
        doorWatch = true
    }
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.bluePortal, function (sprite, otherSprite) {
    if (portal_allowed == true && orangePortalExists == true) {
        lastPortal = 2
        if (orangePortal2.x == Min) {
            mySprite.x = orangePortal2.x + 10
            mySprite.y = orangePortal2.y + 0
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(0)
            } else {
                Render.setViewAngleInDegree(180)
            }
        } else if (orangePortal2.x == 234) {
            mySprite.x = orangePortal2.x + -10
            mySprite.y = orangePortal2.y + 0
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(180)
            } else {
                Render.setViewAngleInDegree(0)
            }
        } else if (orangePortal2.y == Min) {
            mySprite.x = orangePortal2.x + 0
            mySprite.y = orangePortal2.y + 10
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(90)
            } else {
                Render.setViewAngleInDegree(270)
            }
        } else if (orangePortal2.y == 234) {
            mySprite.x = orangePortal2.x + 0
            mySprite.y = orangePortal2.y + -11
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(270)
            } else {
                Render.setViewAngleInDegree(90)
            }
        } else if (newOrangePortalX > orangeSpawnX || newOrangePortalX < orangeSpawnX) {
            mySprite.x = orangePortal2.x + 0
            mySprite.y = orangePortal2.y + -11
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(270)
            } else {
                Render.setViewAngleInDegree(90)
            }
        } else if (newOrangePortalY > orangeSpawnY || newOrangePortalY < orangeSpawnY) {
            mySprite.x = orangePortal2.x + -10
            mySprite.y = orangePortal2.y + 0
            if (!(controller.down.isPressed())) {
                Render.setViewAngleInDegree(180)
            } else {
                Render.setViewAngleInDegree(0)
            }
        }
    }
})
scene.onHitWall(SpriteKind.energyPellet, function (sprite, location) {
    if (tiles.tileAtLocationEquals(location, assets.tile`myTile4`)) {
        tiles.setTileAt(location, assets.tile`myTile3`)
        sprites.destroy(sprite)
        FlagSystem()
    }
})
function EnergyPellet (Initvx: number, Initvy: number) {
    for (let value of tiles.getTilesByType(assets.tile`myTile2`)) {
        energyPellet2 = sprites.create(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . 1 1 1 1 1 1 1 . . . . . 
            . . . 1 4 4 4 4 5 4 4 1 . . . . 
            . . 1 5 4 1 1 5 5 1 4 4 1 . . . 
            . . 1 5 4 4 5 5 1 4 5 4 1 . . . 
            . . 1 5 1 1 4 5 4 1 5 5 1 . . . 
            . . 1 5 5 5 5 5 4 1 5 5 1 . . . 
            . . 1 5 5 5 4 4 5 5 5 5 1 . . . 
            . . 1 5 5 4 4 5 5 4 5 5 1 . . . 
            . . 1 5 4 4 1 1 5 4 4 4 1 . . . 
            . . . 1 4 4 4 4 5 5 5 1 . . . . 
            . . . . 1 1 1 1 1 1 1 . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, SpriteKind.energyPellet)
        energyPellet2.setFlag(SpriteFlag.AutoDestroy, false)
        energyPellet2.setFlag(SpriteFlag.DestroyOnWall, false)
        energyPellet2.setBounceOnWall(true)
        energyPellet2.setPosition(value.x, value.y)
        energyPellet2.setVelocity(Initvx, Initvy)
    }
}
sprites.onDestroyed(SpriteKind.energyPellet, function (sprite) {
    sprite.lifespan = 0
})
sprites.onCreated(SpriteKind.energyPellet, function (sprite) {
    sprite.lifespan = 5000
})
scene.onHitWall(SpriteKind.Projectile, function (sprite, location) {
    if (tiles.tileAtLocationEquals(location, assets.tile`myTile0`)) {
        portal_allowed = true
        if (shootingBlue == true) {
            if (blueportalexists == false) {
                bluePortal2 = sprites.create(img`
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ............................................888888888.....................................
                    .....................................888888888888888888...................................
                    ....................................888888888888888888888.................................
                    ...................................8888888888888888888888888..............................
                    ................................88888888888888888888888888888.............................
                    ...............................8888888888888888888888888888888............................
                    ..............................888888888888888888888888888888888...........................
                    ..............................8888888888888888888888888888888888..........................
                    ............................88888888888888888888888888888888888888........................
                    ..........................888888888888888888888888888888888888888888......................
                    ..........................8888888888888888888888888888888888888888888.....................
                    .........................88888888888888888888888888888888888888888888.....................
                    ........................8888888888888888888888888888888888888888888888....................
                    .......................8888888888888888888888888888888888888888888888888..................
                    .......................88888888888888888888888888888888888888888888888888.................
                    ......................8888888888888888888888888888888888888888888888888888................
                    .....................88888888888888888888888888888888888888888888888888888................
                    .....................88888888888888888888888888888888888888888888888888888................
                    ....................8888888888888888888888888888888888888888888888888888888...............
                    ...................88888888888888888888888888888888888888888888888888888888...............
                    ..................6888888888888888888888888888888888888888888888888888888888..............
                    .................688888888888888888888888888888888888888888888888888888888888.............
                    .................8888888888888888888888888888888888888888888888888888888888888............
                    .................8888888888888888888888888886688888888888888888888888888888888............
                    ................88888888888888888888888888886688888888888888888888888888888888............
                    ................888888888888888888888886888886888888888888888888888888888888888...........
                    ..............68888888888888888888888666688688888888888888888888888888888888888...........
                    .............6888888888888888888888888888888888888888888888888888888888888888888..........
                    .............88888888888888888888888888888888888888888888888888888888888888888888.........
                    ............688888888888888888888888888888888888888888888888888888888888888888888.........
                    ............688888888888888888888888888888888888888888888888888888888888888888888.........
                    ............688688888888888888888668888888888888888888888888888888888888888888888.........
                    ............8886888888888888888886688888888888888888888888888888888888888888888888........
                    ...........68866888888888888888886668888888888888888888888888888888888888888888888........
                    ...........686688888888888888868886888888888888888888888888888888888888888888888886.......
                    ..........6686688888888888888888888888888888888888888888888888888888888888888888888.......
                    ..........68866888888888888888888888888888888888888888888888888888888888888888888886......
                    ..........68868888888888888888888888888888888888888888888888888888888888888888888886......
                    .........668868888888888888888888888888888888888888888888888888886668888888888888888......
                    .........6686688888888888888888888888888888888888888888888888888666668888888888888886.....
                    .........6886688888888888888888888888888888888888888888888888888666668888888888888886.....
                    .........6886688888888888888888888888888888888888888888888888888666668888888888888886.....
                    .........6886888888888888888888888888888888888888888888888888888666668888888888888686.....
                    .........6866888888888888888888888888888888888888888888888888886666668888888888886688.....
                    .........66668888888888888888888888888888888888888888888888888886666688888888888866886....
                    ........866668888888888888888888888888888888888888888888888888888666888888888888866886....
                    ........886666888888888888888888888888888888888888668888888888888866888888888888866688....
                    ........8866688888888888888888888888888888888888886688888888888888888888888888888666888...
                    ........8866668888888888888888888888888888888888886688888888888888888888888888888866686...
                    ........8866668888888888888888888888888888888888886688888888888888888888888888888866686...
                    .......88866688888888888888888888888888888888888888888888888888888888888888888888866668...
                    .......88866888888888888888888888888888888888888888888888888866888888888888888888866668...
                    .......88666888888888888888888888888888888888888888888888888866888888888888888888866668...
                    .......886668888888888888888888888888888888888888888888888888868888888888888888888666668..
                    .......886668888888888888888888888888888888888888888888888888888888888888888888888666668..
                    .......886688888888888888888888888888888888888888888888888888888888888888888888886666688..
                    .......886688888888888888888888888888888888888888888888888888888888888888888888886666688..
                    .......886666688888888888888888888888888888888888888888888888888888888888888888886666668..
                    ......8886666688888888888888888888888888888888888888888888888888888888888888888886666668..
                    ......8866666688888888888888888888888888888888888888888888888888888888888888888886666668..
                    ......88666666888888888888888888888888888888888888888888886888888888888888888886866666688.
                    ......88666666888888888888888888888888888888888888888888886888888888888888888886666666688.
                    ......88666666888888888888888888888888888888888888888888888668888888888888888886666666688.
                    ......88666666688888888888888888888888888888888888888888888888888888888888888886666666688.
                    ......88666666668888888888888888888888888888888888888888888888888888888888888886666666668.
                    ......886666666888888888888888888888888888888888888888888888888888888888888888866666666688
                    ......886666666888888888888888888888888888888888888888888888888888888888888888666666666688
                    ......886666668888888888888888888888888888888888888888888888888888888888888888666666666688
                    .....6886666668888888888888888888888888888888888888888888888888888888888888888666666666688
                    .....8886666666888888888888888888888888888888888888888888888888888888888888888866666666688
                    .....8886666666888888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666888888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888866666666688
                    .....888666666668888888888888888888888888888888888888888888888888888888888888866666666668.
                    .....888666666666888888888888888888888888888888888888888888888888888888888888866666666668.
                    .....888666666666688888888888888888888888888888888888888888888888888888888888666666666668.
                    .....688666666666688888888888888888888888888888888888888888888888888888888888666666666668.
                    .....688666666666688888888888888888888888888888888888888888888888888888888888666666666668.
                    ...66888666666666668888888888888888888888888888888888888888888888888888888886666666666668.
                    ..66688866666666666888888888888888888888888888888888888888888888888888888888666666966668..
                    ..66688866666666666688888888888888888888888888888888888888888888888888888888666669966668..
                    ..66888866666666666688888888888888888888888888888888888888888888888888888886666669966666..
                    ...6888866696666666688888888888888888888888888888888888888888888888888888886666669966666..
                    ...6888866696666666688888888888888888888888888888888888888888888888888888866666669666666..
                    ....888886696666668888888888888888888888888888888888888888888888888888888666666669666686..
                    ....68888666666666688888888888888888888888888888888888888888888888888888866666666966668...
                    ....68888666966666668888888888888888888888888888888888888888888888888888866666669996668...
                    .....8886666966666668888888888888888888888888888888888888888888888888886666666669996668...
                    ......888666966666668888888888888888888888888888888888888888888888888886666666669996668...
                    ......888666666666666888888888888888888888888888888888888888888888888886666666669966668...
                    ......888666966666666888888888888888888888888888888888888888888888888866666666669966668...
                    .......88866966666666888888888888888888888888888888888688888888888888866666666699666668...
                    .......88866699666666688888888888888888888888888888888888888888888888666666666699666668...
                    .......8886669996666666688888888888888888888888888888888888888888888866666666699966666....
                    ........886669999666666668888888888888888888888888888888888888888888866666666699966688....
                    ........886669999966666668888888888888888888888888888888868888888888866666669999966688....
                    ........888869999966666666888888888888888688866888888888666888888888866666669999668688....
                    .........8886699999666666688888888888888868866666888888886888888888886666666999966666.....
                    .........886869999996666666888888888888888888668668888888888888888886666666699996666......
                    ..........88866999996666666888888888888888888888888888888888888888866666996699966666......
                    ..........88866999996666666688888888888888888888888888888888888888866669999999966666......
                    ..........88866999996666666668888888888888888888888888888888888888866669999999966666......
                    ...........888699999666666666688888886688888888888888888886888888866666999999996866.......
                    ...........888669999666666666688888886688888888888868888886688888666666999999966866.......
                    ............8866999999666966666888888668888888888886688888888888666666999999996666........
                    ............888669999996699666666866866888668888888668888888666666666699999996666.........
                    .............88669999999999966666886666888668888888868888888666666666699999996668.........
                    .............88869999999999996666668888888866888888888888886666666666699999996688.........
                    ..............886699999999999966668888888886688888868888888666666669999999996668..........
                    ..............886669999999999966668888888886688888666888888666699999999999996688..........
                    ...............8866999999999999666688888888668888866688888666699999999999996668...........
                    ................886699999999999666688888888688888666666886666999999999999996688...........
                    .................8869999999999996666688888866888866666666666699999999999996688............
                    .................886699999999999966666688866688866669666666669999999999999688.............
                    .................886669999999999966666666866666666699996666669999999999996888.............
                    ..................88666999999999996666666666666666669999666699999999999966888.............
                    ..................8886699999999999999966666666666666999996999999999999996888..............
                    ...................88866999999999999999666966669966999999999999999999996688...............
                    ....................886699999999999999999999666999999999999999999999996688................
                    .....................86669999999999999999999969999999999999999999999966888................
                    .....................8866999999999999999999999999999999999999999999966888.................
                    ......................886699999999999999999999999999999999999999999668888.................
                    .......................886699999999999999999999999999999999999999966888...................
                    ........................8886699999999999999999999999999999999999996688....................
                    ........................88886699999999999999999999999999999999996666......................
                    .........................888666999999999999999999999999999999996668.......................
                    ...........................886669999999999999999999999999999999688........................
                    .............................866699999999999999999999999999999688.........................
                    ..............................8866999999999999999999999999996668..........................
                    ...............................88666999999999999999999999996688...........................
                    ...............................888866699999999999999999666668.............................
                    ..................................8866666999999999966666688...............................
                    ....................................8886666996666666668888................................
                    .....................................8888666666666688888..................................
                    .......................................8888888888888......................................
                    ...........................................88888..........................................
                    `, SpriteKind.bluePortal)
                bluePortal2.setScale(0.1, ScaleAnchor.Middle)
                bluePortal2.setPosition(sprite.x, sprite.y)
                blueportalexists = true
                blueSpawnX = sprite.x
                blueSpwanY = sprite.y
                newBluePortalX = Math.round(blueSpawnX)
                newBluePortalY = Math.round(blueSpwanY)
            } else if (blueportalexists == true) {
                sprites.destroy(bluePortal2)
                blueportalexists = false
                bluePortal2 = sprites.create(img`
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ............................................888888888.....................................
                    .....................................888888888888888888...................................
                    ....................................888888888888888888888.................................
                    ...................................8888888888888888888888888..............................
                    ................................88888888888888888888888888888.............................
                    ...............................8888888888888888888888888888888............................
                    ..............................888888888888888888888888888888888...........................
                    ..............................8888888888888888888888888888888888..........................
                    ............................88888888888888888888888888888888888888........................
                    ..........................888888888888888888888888888888888888888888......................
                    ..........................8888888888888888888888888888888888888888888.....................
                    .........................88888888888888888888888888888888888888888888.....................
                    ........................8888888888888888888888888888888888888888888888....................
                    .......................8888888888888888888888888888888888888888888888888..................
                    .......................88888888888888888888888888888888888888888888888888.................
                    ......................8888888888888888888888888888888888888888888888888888................
                    .....................88888888888888888888888888888888888888888888888888888................
                    .....................88888888888888888888888888888888888888888888888888888................
                    ....................8888888888888888888888888888888888888888888888888888888...............
                    ...................88888888888888888888888888888888888888888888888888888888...............
                    ..................6888888888888888888888888888888888888888888888888888888888..............
                    .................688888888888888888888888888888888888888888888888888888888888.............
                    .................8888888888888888888888888888888888888888888888888888888888888............
                    .................8888888888888888888888888886688888888888888888888888888888888............
                    ................88888888888888888888888888886688888888888888888888888888888888............
                    ................888888888888888888888886888886888888888888888888888888888888888...........
                    ..............68888888888888888888888666688688888888888888888888888888888888888...........
                    .............6888888888888888888888888888888888888888888888888888888888888888888..........
                    .............88888888888888888888888888888888888888888888888888888888888888888888.........
                    ............688888888888888888888888888888888888888888888888888888888888888888888.........
                    ............688888888888888888888888888888888888888888888888888888888888888888888.........
                    ............688688888888888888888668888888888888888888888888888888888888888888888.........
                    ............8886888888888888888886688888888888888888888888888888888888888888888888........
                    ...........68866888888888888888886668888888888888888888888888888888888888888888888........
                    ...........686688888888888888868886888888888888888888888888888888888888888888888886.......
                    ..........6686688888888888888888888888888888888888888888888888888888888888888888888.......
                    ..........68866888888888888888888888888888888888888888888888888888888888888888888886......
                    ..........68868888888888888888888888888888888888888888888888888888888888888888888886......
                    .........668868888888888888888888888888888888888888888888888888886668888888888888888......
                    .........6686688888888888888888888888888888888888888888888888888666668888888888888886.....
                    .........6886688888888888888888888888888888888888888888888888888666668888888888888886.....
                    .........6886688888888888888888888888888888888888888888888888888666668888888888888886.....
                    .........6886888888888888888888888888888888888888888888888888888666668888888888888686.....
                    .........6866888888888888888888888888888888888888888888888888886666668888888888886688.....
                    .........66668888888888888888888888888888888888888888888888888886666688888888888866886....
                    ........866668888888888888888888888888888888888888888888888888888666888888888888866886....
                    ........886666888888888888888888888888888888888888668888888888888866888888888888866688....
                    ........8866688888888888888888888888888888888888886688888888888888888888888888888666888...
                    ........8866668888888888888888888888888888888888886688888888888888888888888888888866686...
                    ........8866668888888888888888888888888888888888886688888888888888888888888888888866686...
                    .......88866688888888888888888888888888888888888888888888888888888888888888888888866668...
                    .......88866888888888888888888888888888888888888888888888888866888888888888888888866668...
                    .......88666888888888888888888888888888888888888888888888888866888888888888888888866668...
                    .......886668888888888888888888888888888888888888888888888888868888888888888888888666668..
                    .......886668888888888888888888888888888888888888888888888888888888888888888888888666668..
                    .......886688888888888888888888888888888888888888888888888888888888888888888888886666688..
                    .......886688888888888888888888888888888888888888888888888888888888888888888888886666688..
                    .......886666688888888888888888888888888888888888888888888888888888888888888888886666668..
                    ......8886666688888888888888888888888888888888888888888888888888888888888888888886666668..
                    ......8866666688888888888888888888888888888888888888888888888888888888888888888886666668..
                    ......88666666888888888888888888888888888888888888888888886888888888888888888886866666688.
                    ......88666666888888888888888888888888888888888888888888886888888888888888888886666666688.
                    ......88666666888888888888888888888888888888888888888888888668888888888888888886666666688.
                    ......88666666688888888888888888888888888888888888888888888888888888888888888886666666688.
                    ......88666666668888888888888888888888888888888888888888888888888888888888888886666666668.
                    ......886666666888888888888888888888888888888888888888888888888888888888888888866666666688
                    ......886666666888888888888888888888888888888888888888888888888888888888888888666666666688
                    ......886666668888888888888888888888888888888888888888888888888888888888888888666666666688
                    .....6886666668888888888888888888888888888888888888888888888888888888888888888666666666688
                    .....8886666666888888888888888888888888888888888888888888888888888888888888888866666666688
                    .....8886666666888888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666888888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888886666666688
                    .....8886666666688888888888888888888888888888888888888888888888888888888888888866666666688
                    .....888666666668888888888888888888888888888888888888888888888888888888888888866666666668.
                    .....888666666666888888888888888888888888888888888888888888888888888888888888866666666668.
                    .....888666666666688888888888888888888888888888888888888888888888888888888888666666666668.
                    .....688666666666688888888888888888888888888888888888888888888888888888888888666666666668.
                    .....688666666666688888888888888888888888888888888888888888888888888888888888666666666668.
                    ...66888666666666668888888888888888888888888888888888888888888888888888888886666666666668.
                    ..66688866666666666888888888888888888888888888888888888888888888888888888888666666966668..
                    ..66688866666666666688888888888888888888888888888888888888888888888888888888666669966668..
                    ..66888866666666666688888888888888888888888888888888888888888888888888888886666669966666..
                    ...6888866696666666688888888888888888888888888888888888888888888888888888886666669966666..
                    ...6888866696666666688888888888888888888888888888888888888888888888888888866666669666666..
                    ....888886696666668888888888888888888888888888888888888888888888888888888666666669666686..
                    ....68888666666666688888888888888888888888888888888888888888888888888888866666666966668...
                    ....68888666966666668888888888888888888888888888888888888888888888888888866666669996668...
                    .....8886666966666668888888888888888888888888888888888888888888888888886666666669996668...
                    ......888666966666668888888888888888888888888888888888888888888888888886666666669996668...
                    ......888666666666666888888888888888888888888888888888888888888888888886666666669966668...
                    ......888666966666666888888888888888888888888888888888888888888888888866666666669966668...
                    .......88866966666666888888888888888888888888888888888688888888888888866666666699666668...
                    .......88866699666666688888888888888888888888888888888888888888888888666666666699666668...
                    .......8886669996666666688888888888888888888888888888888888888888888866666666699966666....
                    ........886669999666666668888888888888888888888888888888888888888888866666666699966688....
                    ........886669999966666668888888888888888888888888888888868888888888866666669999966688....
                    ........888869999966666666888888888888888688866888888888666888888888866666669999668688....
                    .........8886699999666666688888888888888868866666888888886888888888886666666999966666.....
                    .........886869999996666666888888888888888888668668888888888888888886666666699996666......
                    ..........88866999996666666888888888888888888888888888888888888888866666996699966666......
                    ..........88866999996666666688888888888888888888888888888888888888866669999999966666......
                    ..........88866999996666666668888888888888888888888888888888888888866669999999966666......
                    ...........888699999666666666688888886688888888888888888886888888866666999999996866.......
                    ...........888669999666666666688888886688888888888868888886688888666666999999966866.......
                    ............8866999999666966666888888668888888888886688888888888666666999999996666........
                    ............888669999996699666666866866888668888888668888888666666666699999996666.........
                    .............88669999999999966666886666888668888888868888888666666666699999996668.........
                    .............88869999999999996666668888888866888888888888886666666666699999996688.........
                    ..............886699999999999966668888888886688888868888888666666669999999996668..........
                    ..............886669999999999966668888888886688888666888888666699999999999996688..........
                    ...............8866999999999999666688888888668888866688888666699999999999996668...........
                    ................886699999999999666688888888688888666666886666999999999999996688...........
                    .................8869999999999996666688888866888866666666666699999999999996688............
                    .................886699999999999966666688866688866669666666669999999999999688.............
                    .................886669999999999966666666866666666699996666669999999999996888.............
                    ..................88666999999999996666666666666666669999666699999999999966888.............
                    ..................8886699999999999999966666666666666999996999999999999996888..............
                    ...................88866999999999999999666966669966999999999999999999996688...............
                    ....................886699999999999999999999666999999999999999999999996688................
                    .....................86669999999999999999999969999999999999999999999966888................
                    .....................8866999999999999999999999999999999999999999999966888.................
                    ......................886699999999999999999999999999999999999999999668888.................
                    .......................886699999999999999999999999999999999999999966888...................
                    ........................8886699999999999999999999999999999999999996688....................
                    ........................88886699999999999999999999999999999999996666......................
                    .........................888666999999999999999999999999999999996668.......................
                    ...........................886669999999999999999999999999999999688........................
                    .............................866699999999999999999999999999999688.........................
                    ..............................8866999999999999999999999999996668..........................
                    ...............................88666999999999999999999999996688...........................
                    ...............................888866699999999999999999666668.............................
                    ..................................8866666999999999966666688...............................
                    ....................................8886666996666666668888................................
                    .....................................8888666666666688888..................................
                    .......................................8888888888888......................................
                    ...........................................88888..........................................
                    `, SpriteKind.bluePortal)
                bluePortal2.setScale(0.1, ScaleAnchor.Middle)
                bluePortal2.setPosition(sprite.x, sprite.y)
                blueportalexists = true
                blueSpawnX = sprite.x
                blueSpwanY = sprite.y
                newBluePortalX = Math.round(blueSpawnX)
                newBluePortalY = Math.round(blueSpwanY)
            }
            shootingBlue = false
            lastShot = 1
        } else if (shootingOrange == true) {
            if (orangePortalExists == false) {
                orangePortal2 = sprites.create(img`
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ............................................444444444.....................................
                    .....................................444444444444444444...................................
                    ....................................444444444444444444444.................................
                    ...................................4444444444444444444444444..............................
                    ................................44444444444444444444444444444.............................
                    ...............................4444444444444444444444444444444............................
                    ..............................444444444444444444444444444444444...........................
                    ..............................4444444444444444444444444444444444..........................
                    ............................44444444444444444444444444444444444444........................
                    ..........................444444444444444444444444444444444444444444......................
                    ..........................4444444444444444444444444444444444444444444.....................
                    .........................44444444444444444444444444444444444444444444.....................
                    ........................4444444444444444444444444444444444444444444444....................
                    .......................4444444444444444444444444444444444444444444444444..................
                    .......................44444444444444444444444444444444444444444444444444.................
                    ......................4444444444444444444444444444444444444444444444444444................
                    .....................44444444444444444444444444444444444444444444444444444................
                    .....................44444444444444444444444444444444444444444444444444444................
                    ....................4444444444444444444444444444444444444444444444444444444...............
                    ...................44444444444444444444444444444444444444444444444444444444...............
                    ..................5444444444444444444444444444444444444444444444444444444444..............
                    .................544444444444444444444444444444444444444444444444444444444444.............
                    .................4444444444444444444444444444444444444444444444444444444444444............
                    .................4444444444444444444444444445544444444444444444444444444444444............
                    ................44444444444444444444444444445544444444444444444444444444444444............
                    ................444444444444444444444445444445444444444444444444444444444444444...........
                    ..............54444444444444444444444555544544444444444444444444444444444444444...........
                    .............5444444444444444444444444444444444444444444444444444444444444444444..........
                    .............44444444444444444444444444444444444444444444444444444444444444444444.........
                    ............544444444444444444444444444444444444444444444444444444444444444444444.........
                    ............544444444444444444444444444444444444444444444444444444444444444444444.........
                    ............544544444444444444444554444444444444444444444444444444444444444444444.........
                    ............4445444444444444444445544444444444444444444444444444444444444444444444........
                    ...........54455444444444444444445554444444444444444444444444444444444444444444444........
                    ...........545544444444444444454445444444444444444444444444444444444444444444444445.......
                    ..........5545544444444444444444444444444444444444444444444444444444444444444444444.......
                    ..........54455444444444444444444444444444444444444444444444444444444444444444444445......
                    ..........54454444444444444444444444444444444444444444444444444444444444444444444445......
                    .........554454444444444444444444444444444444444444444444444444445554444444444444444......
                    .........5545544444444444444444444444444444444444444444444444444555554444444444444445.....
                    .........5445544444444444444444444444444444444444444444444444444555554444444444444445.....
                    .........5445544444444444444444444444444444444444444444444444444555554444444444444445.....
                    .........5445444444444444444444444444444444444444444444444444444555554444444444444545.....
                    .........5455444444444444444444444444444444444444444444444444445555554444444444445544.....
                    .........55554444444444444444444444444444444444444444444444444445555544444444444455445....
                    ........455554444444444444444444444444444444444444444444444444444555444444444444455445....
                    ........445555444444444444444444444444444444444444554444444444444455444444444444455544....
                    ........4455544444444444444444444444444444444444445544444444444444444444444444444555444...
                    ........4455554444444444444444444444444444444444445544444444444444444444444444444455545...
                    ........4455554444444444444444444444444444444444445544444444444444444444444444444455545...
                    .......44455544444444444444444444444444444444444444444444444444444444444444444444455554...
                    .......44455444444444444444444444444444444444444444444444444455444444444444444444455554...
                    .......44555444444444444444444444444444444444444444444444444455444444444444444444455554...
                    .......445554444444444444444444444444444444444444444444444444454444444444444444444555554..
                    .......445554444444444444444444444444444444444444444444444444444444444444444444444555554..
                    .......445544444444444444444444444444444444444444444444444444444444444444444444445555544..
                    .......445544444444444444444444444444444444444444444444444444444444444444444444445555544..
                    .......445555544444444444444444444444444444444444444444444444444444444444444444445555554..
                    ......4445555544444444444444444444444444444444444444444444444444444444444444444445555554..
                    ......4455555544444444444444444444444444444444444444444444444444444444444444444445555554..
                    ......44555555444444444444444444444444444444444444444444445444444444444444444445455555544.
                    ......44555555444444444444444444444444444444444444444444445444444444444444444445555555544.
                    ......44555555444444444444444444444444444444444444444444444554444444444444444445555555544.
                    ......44555555544444444444444444444444444444444444444444444444444444444444444445555555544.
                    ......44555555554444444444444444444444444444444444444444444444444444444444444445555555554.
                    ......445555555444444444444444444444444444444444444444444444444444444444444444455555555544
                    ......445555555444444444444444444444444444444444444444444444444444444444444444555555555544
                    ......445555554444444444444444444444444444444444444444444444444444444444444444555555555544
                    .....5445555554444444444444444444444444444444444444444444444444444444444444444555555555544
                    .....4445555555444444444444444444444444444444444444444444444444444444444444444455555555544
                    .....4445555555444444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555444444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444455555555544
                    .....444555555554444444444444444444444444444444444444444444444444444444444444455555555554.
                    .....444555555555444444444444444444444444444444444444444444444444444444444444455555555554.
                    .....444555555555544444444444444444444444444444444444444444444444444444444444555555555554.
                    .....544555555555544444444444444444444444444444444444444444444444444444444444555555555554.
                    .....544555555555544444444444444444444444444444444444444444444444444444444444555555555554.
                    ...55444555555555554444444444444444444444444444444444444444444444444444444445555555555554.
                    ..55544455555555555444444444444444444444444444444444444444444444444444444444555555555554..
                    ..55544455555555555544444444444444444444444444444444444444444444444444444444555555555554..
                    ..55444455555555555544444444444444444444444444444444444444444444444444444445555555555555..
                    ...5444455545555555544444444444444444444444444444444444444444444444444444445555555555555..
                    ...5444455545555555544444444444444444444444444444444444444444444444444444455555555555555..
                    ....444445545555554444444444444444444444444444444444444444444444444444444555555555555545..
                    ....54444555555555544444444444444444444444444444444444444444444444444444455555555555554...
                    ....54444555455555554444444444444444444444444444444444444444444444444444455555555555554...
                    .....4445555455555554444444444444444444444444444444444444444444444444445555555555555554...
                    ......444555455555554444444444444444444444444444444444444444444444444445555555555555554...
                    ......444555555555555444444444444444444444444444444444444444444444444445555555555555554...
                    ......444555455555555444444444444444444444444444444444444444444444444455555555555555554...
                    .......44455455555555444444444444444444444444444444444544444444444444455555555555555554...
                    .......44455555555555544444444444444444444444444444444444444444444444555555555555555554...
                    .......4445555555555555544444444444444444444444444444444444444444444455555555555555555....
                    ........445555555555555554444444444444444444444444444444444444444444455555555555555544....
                    ........445555555555555554444444444444444444444444444444454444444444455555555555555544....
                    ........444455555555555555444444444444444544455444444444555444444444455555555555554544....
                    .........4445555555555555544444444444444454455555444444445444444444445555555555555555.....
                    .........445455555555555555444444444444444444554554444444444444444445555555555555555......
                    ..........44455555555555555444444444444444444444444444444444444444455555555555555555......
                    ..........44455555555555555544444444444444444444444444444444444444455555555555555555......
                    ..........44455555555555555554444444444444444444444444444444444444455555555555555555......
                    ...........444555555555555555544444445544444444444444444445444444455555555555555455.......
                    ...........444555555555555555544444445544444444444454444445544444555555555555555455.......
                    ............4455555555555555555444444554444444444445544444444444555555555555555555........
                    ............444555555555555555555455455444554444444554444444555555555555555555555.........
                    .............44555555555555555555445555444554444444454444444555555555555555555554.........
                    .............44455555555555555555554444444455444444444444445555555555555555555544.........
                    ..............445555555555555555554444444445544444454444444555555555555555555554..........
                    ..............445555555555555555554444444445544444555444444555555555555555555544..........
                    ...............4455555555555555555544444444554444455544444555555555555555555554...........
                    ................445555555555555555544444444544444555555445555555555555555555544...........
                    .................4455555555555555555544444455444455555555555555555555555555544............
                    .................445555555555555555555544455544455555555555555555555555555544.............
                    .................445555555555555555555555455555555555555555555555555555555444.............
                    ..................44555555555555555555555555555555555555555555555555555555444.............
                    ..................4445555555555555555555555555555555555555555555555555555444..............
                    ...................44455555555555555555555555555555555555555555555555555544...............
                    ....................445555555555555555555555555555555555555555555555555544................
                    .....................45555555555555555555555555555555555555555555555555444................
                    .....................4455555555555555555555555555555555555555555555555444.................
                    ......................445555555555555555555555555555555555555555555554444.................
                    .......................445555555555555555555555555555555555555555555444...................
                    ........................4445555555555555555555555555555555555555555544....................
                    ........................44445555555555555555555555555555555555555555......................
                    .........................444555555555555555555555555555555555555554.......................
                    ...........................445555555555555555555555555555555555544........................
                    .............................455555555555555555555555555555555544.........................
                    ..............................4455555555555555555555555555555554..........................
                    ...............................44555555555555555555555555555544...........................
                    ...............................444455555555555555555555555554.............................
                    ..................................4455555555555555555555544...............................
                    ....................................4445555555555555554444................................
                    .....................................4444555555555544444..................................
                    .......................................4444444444444......................................
                    ...........................................44444..........................................
                    `, SpriteKind.orangePortal)
                orangePortal2.setScale(0.1, ScaleAnchor.Middle)
                orangePortal2.setPosition(sprite.x, sprite.y)
                orangePortalExists = true
                orangeSpawnX = sprite.x
                orangeSpawnY = sprite.y
                newOrangePortalX = Math.round(orangeSpawnX)
                newOrangePortalY = Math.round(orangeSpawnY)
            } else if (orangePortalExists == true) {
                sprites.destroy(orangePortal2)
                orangePortalExists = false
                orangePortal2 = sprites.create(img`
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ..........................................................................................
                    ............................................444444444.....................................
                    .....................................444444444444444444...................................
                    ....................................444444444444444444444.................................
                    ...................................4444444444444444444444444..............................
                    ................................44444444444444444444444444444.............................
                    ...............................4444444444444444444444444444444............................
                    ..............................444444444444444444444444444444444...........................
                    ..............................4444444444444444444444444444444444..........................
                    ............................44444444444444444444444444444444444444........................
                    ..........................444444444444444444444444444444444444444444......................
                    ..........................4444444444444444444444444444444444444444444.....................
                    .........................44444444444444444444444444444444444444444444.....................
                    ........................4444444444444444444444444444444444444444444444....................
                    .......................4444444444444444444444444444444444444444444444444..................
                    .......................44444444444444444444444444444444444444444444444444.................
                    ......................4444444444444444444444444444444444444444444444444444................
                    .....................44444444444444444444444444444444444444444444444444444................
                    .....................44444444444444444444444444444444444444444444444444444................
                    ....................4444444444444444444444444444444444444444444444444444444...............
                    ...................44444444444444444444444444444444444444444444444444444444...............
                    ..................5444444444444444444444444444444444444444444444444444444444..............
                    .................544444444444444444444444444444444444444444444444444444444444.............
                    .................4444444444444444444444444444444444444444444444444444444444444............
                    .................4444444444444444444444444445544444444444444444444444444444444............
                    ................44444444444444444444444444445544444444444444444444444444444444............
                    ................444444444444444444444445444445444444444444444444444444444444444...........
                    ..............54444444444444444444444555544544444444444444444444444444444444444...........
                    .............5444444444444444444444444444444444444444444444444444444444444444444..........
                    .............44444444444444444444444444444444444444444444444444444444444444444444.........
                    ............544444444444444444444444444444444444444444444444444444444444444444444.........
                    ............544444444444444444444444444444444444444444444444444444444444444444444.........
                    ............544544444444444444444554444444444444444444444444444444444444444444444.........
                    ............4445444444444444444445544444444444444444444444444444444444444444444444........
                    ...........54455444444444444444445554444444444444444444444444444444444444444444444........
                    ...........545544444444444444454445444444444444444444444444444444444444444444444445.......
                    ..........5545544444444444444444444444444444444444444444444444444444444444444444444.......
                    ..........54455444444444444444444444444444444444444444444444444444444444444444444445......
                    ..........54454444444444444444444444444444444444444444444444444444444444444444444445......
                    .........554454444444444444444444444444444444444444444444444444445554444444444444444......
                    .........5545544444444444444444444444444444444444444444444444444555554444444444444445.....
                    .........5445544444444444444444444444444444444444444444444444444555554444444444444445.....
                    .........5445544444444444444444444444444444444444444444444444444555554444444444444445.....
                    .........5445444444444444444444444444444444444444444444444444444555554444444444444545.....
                    .........5455444444444444444444444444444444444444444444444444445555554444444444445544.....
                    .........55554444444444444444444444444444444444444444444444444445555544444444444455445....
                    ........455554444444444444444444444444444444444444444444444444444555444444444444455445....
                    ........445555444444444444444444444444444444444444554444444444444455444444444444455544....
                    ........4455544444444444444444444444444444444444445544444444444444444444444444444555444...
                    ........4455554444444444444444444444444444444444445544444444444444444444444444444455545...
                    ........4455554444444444444444444444444444444444445544444444444444444444444444444455545...
                    .......44455544444444444444444444444444444444444444444444444444444444444444444444455554...
                    .......44455444444444444444444444444444444444444444444444444455444444444444444444455554...
                    .......44555444444444444444444444444444444444444444444444444455444444444444444444455554...
                    .......445554444444444444444444444444444444444444444444444444454444444444444444444555554..
                    .......445554444444444444444444444444444444444444444444444444444444444444444444444555554..
                    .......445544444444444444444444444444444444444444444444444444444444444444444444445555544..
                    .......445544444444444444444444444444444444444444444444444444444444444444444444445555544..
                    .......445555544444444444444444444444444444444444444444444444444444444444444444445555554..
                    ......4445555544444444444444444444444444444444444444444444444444444444444444444445555554..
                    ......4455555544444444444444444444444444444444444444444444444444444444444444444445555554..
                    ......44555555444444444444444444444444444444444444444444445444444444444444444445455555544.
                    ......44555555444444444444444444444444444444444444444444445444444444444444444445555555544.
                    ......44555555444444444444444444444444444444444444444444444554444444444444444445555555544.
                    ......44555555544444444444444444444444444444444444444444444444444444444444444445555555544.
                    ......44555555554444444444444444444444444444444444444444444444444444444444444445555555554.
                    ......445555555444444444444444444444444444444444444444444444444444444444444444455555555544
                    ......445555555444444444444444444444444444444444444444444444444444444444444444555555555544
                    ......445555554444444444444444444444444444444444444444444444444444444444444444555555555544
                    .....5445555554444444444444444444444444444444444444444444444444444444444444444555555555544
                    .....4445555555444444444444444444444444444444444444444444444444444444444444444455555555544
                    .....4445555555444444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555444444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444445555555544
                    .....4445555555544444444444444444444444444444444444444444444444444444444444444455555555544
                    .....444555555554444444444444444444444444444444444444444444444444444444444444455555555554.
                    .....444555555555444444444444444444444444444444444444444444444444444444444444455555555554.
                    .....444555555555544444444444444444444444444444444444444444444444444444444444555555555554.
                    .....544555555555544444444444444444444444444444444444444444444444444444444444555555555554.
                    .....544555555555544444444444444444444444444444444444444444444444444444444444555555555554.
                    ...55444555555555554444444444444444444444444444444444444444444444444444444445555555555554.
                    ..55544455555555555444444444444444444444444444444444444444444444444444444444555555555554..
                    ..55544455555555555544444444444444444444444444444444444444444444444444444444555555555554..
                    ..55444455555555555544444444444444444444444444444444444444444444444444444445555555555555..
                    ...5444455545555555544444444444444444444444444444444444444444444444444444445555555555555..
                    ...5444455545555555544444444444444444444444444444444444444444444444444444455555555555555..
                    ....444445545555554444444444444444444444444444444444444444444444444444444555555555555545..
                    ....54444555555555544444444444444444444444444444444444444444444444444444455555555555554...
                    ....54444555455555554444444444444444444444444444444444444444444444444444455555555555554...
                    .....4445555455555554444444444444444444444444444444444444444444444444445555555555555554...
                    ......444555455555554444444444444444444444444444444444444444444444444445555555555555554...
                    ......444555555555555444444444444444444444444444444444444444444444444445555555555555554...
                    ......444555455555555444444444444444444444444444444444444444444444444455555555555555554...
                    .......44455455555555444444444444444444444444444444444544444444444444455555555555555554...
                    .......44455555555555544444444444444444444444444444444444444444444444555555555555555554...
                    .......4445555555555555544444444444444444444444444444444444444444444455555555555555555....
                    ........445555555555555554444444444444444444444444444444444444444444455555555555555544....
                    ........445555555555555554444444444444444444444444444444454444444444455555555555555544....
                    ........444455555555555555444444444444444544455444444444555444444444455555555555554544....
                    .........4445555555555555544444444444444454455555444444445444444444445555555555555555.....
                    .........445455555555555555444444444444444444554554444444444444444445555555555555555......
                    ..........44455555555555555444444444444444444444444444444444444444455555555555555555......
                    ..........44455555555555555544444444444444444444444444444444444444455555555555555555......
                    ..........44455555555555555554444444444444444444444444444444444444455555555555555555......
                    ...........444555555555555555544444445544444444444444444445444444455555555555555455.......
                    ...........444555555555555555544444445544444444444454444445544444555555555555555455.......
                    ............4455555555555555555444444554444444444445544444444444555555555555555555........
                    ............444555555555555555555455455444554444444554444444555555555555555555555.........
                    .............44555555555555555555445555444554444444454444444555555555555555555554.........
                    .............44455555555555555555554444444455444444444444445555555555555555555544.........
                    ..............445555555555555555554444444445544444454444444555555555555555555554..........
                    ..............445555555555555555554444444445544444555444444555555555555555555544..........
                    ...............4455555555555555555544444444554444455544444555555555555555555554...........
                    ................445555555555555555544444444544444555555445555555555555555555544...........
                    .................4455555555555555555544444455444455555555555555555555555555544............
                    .................445555555555555555555544455544455555555555555555555555555544.............
                    .................445555555555555555555555455555555555555555555555555555555444.............
                    ..................44555555555555555555555555555555555555555555555555555555444.............
                    ..................4445555555555555555555555555555555555555555555555555555444..............
                    ...................44455555555555555555555555555555555555555555555555555544...............
                    ....................445555555555555555555555555555555555555555555555555544................
                    .....................45555555555555555555555555555555555555555555555555444................
                    .....................4455555555555555555555555555555555555555555555555444.................
                    ......................445555555555555555555555555555555555555555555554444.................
                    .......................445555555555555555555555555555555555555555555444...................
                    ........................4445555555555555555555555555555555555555555544....................
                    ........................44445555555555555555555555555555555555555555......................
                    .........................444555555555555555555555555555555555555554.......................
                    ...........................445555555555555555555555555555555555544........................
                    .............................455555555555555555555555555555555544.........................
                    ..............................4455555555555555555555555555555554..........................
                    ...............................44555555555555555555555555555544...........................
                    ...............................444455555555555555555555555554.............................
                    ..................................4455555555555555555555544...............................
                    ....................................4445555555555555554444................................
                    .....................................4444555555555544444..................................
                    .......................................4444444444444......................................
                    ...........................................44444..........................................
                    `, SpriteKind.orangePortal)
                orangePortal2.setScale(0.1, ScaleAnchor.Middle)
                orangePortal2.setPosition(sprite.x, sprite.y)
                orangePortalExists = true
                orangeSpawnX = sprite.x
                orangeSpawnY = sprite.y
                newOrangePortalX = Math.round(orangeSpawnX)
                newOrangePortalY = Math.round(orangeSpawnY)
            }
            shootingOrange = false
            lastShot = 2
        }
    }
})
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    shootingBlue = true
    bluePortalShot = sprites.createProjectileFromSprite(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . 8 8 8 8 8 8 8 . . . . 
        . . . . 8 9 9 9 9 9 9 9 8 . . . 
        . . . 8 9 9 9 9 9 9 9 9 9 8 . . 
        . . . 8 9 9 9 8 8 8 9 9 9 8 . . 
        . . . 8 9 9 8 8 9 8 8 9 9 8 . . 
        . . . 8 9 9 8 9 9 9 8 9 9 8 . . 
        . . . 8 9 9 8 8 9 8 8 9 9 8 . . 
        . . . 8 9 9 9 8 8 8 9 9 9 8 . . 
        . . . 8 9 9 9 9 9 9 9 9 9 8 . . 
        . . . . 8 9 9 9 9 9 9 9 8 . . . 
        . . . . . 8 8 8 8 8 8 8 . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, mySprite, Render.getAttribute(Render.attribute.dirX) * 100 + randint(-10, 10), Render.getAttribute(Render.attribute.dirY) * 100 + randint(-10, 10))
    bluePortalShot.setFlag(SpriteFlag.AutoDestroy, false)
    music.play(music.createSoundEffect(WaveShape.Sine, 1155, 1, 255, 0, 500, SoundExpressionEffect.Warble, InterpolationCurve.Linear), music.PlaybackMode.InBackground)
})
sprites.onOverlap(SpriteKind.energyPellet, SpriteKind.orangePortal, function (sprite, otherSprite) {
    if (pelletAllowed == true && blueportalexists == true) {
        energyPellet2.x = bluePortal2.x + 0
        energyPellet2.y = bluePortal2.y + 0
        if (orangePortal2.x == bluePortal2.x) {
            energyPellet2.setVelocity(0, 0 - energyPellet2.vy)
        } else if (orangePortal2.y == bluePortal2.y) {
            energyPellet2.setVelocity(0 - energyPellet2.vx, 0)
        }
        if (bluePortal2.x == Min) {
            energyPellet2.setVelocity(100, 0)
        } else if (bluePortal2.x == Max) {
            energyPellet2.setVelocity(100, 0)
        } else if (bluePortal2.y == Min) {
            energyPellet2.setVelocity(0, 100)
        } else if (bluePortal2.y == Max) {
            energyPellet2.setVelocity(0, 100)
        } else if (newBluePortalX > blueSpawnX || newBluePortalX < blueSpawnX) {
            energyPellet2.setVelocity(0, 100)
        } else if (newBluePortalY > blueSpwanY || newBluePortalY < blueSpwanY) {
            energyPellet2.setVelocity(100, 0)
        }
    }
    pelletAllowed = false
    pause(100)
    pelletAllowed = true
})
function levelSystem () {
    if (TESTCHAMBER == 1) {
        Max = 234
        Min = 21
        tiles.setCurrentTilemap(tilemap`level3`)
        Render.setCeilingTilemap(tilemap`level12`)
        EnergyPellet(0, -100)
    }
}
let bluePortalShot: Sprite = null
let shootingBlue = false
let doorWatch = false
let Ididsomethingbluex = false
let blueSpwanY = 0
let newBluePortalY = 0
let blueSpawnX = 0
let newBluePortalX = 0
let lastPortal = 0
let blueportalexists = false
let portal_allowed = false
let lastShot = 0
let orangPortalShot: Sprite = null
let shootingOrange = false
let orangeSpawnY = 0
let newOrangePortalY = 0
let orangeSpawnX = 0
let newOrangePortalX = 0
let Max = 0
let Min = 0
let bluePortal2: Sprite = null
let orangePortal2: Sprite = null
let energyPellet2: Sprite = null
let orangePortalExists = false
let pelletAllowed = false
let mySprite: Sprite = null
let FLAG1 = false
let TESTCHAMBER = 0
TESTCHAMBER = 1
FLAG1 = false
levelSystem()
mySprite = Render.getRenderSpriteVariable()
let portalPoint = sprites.create(img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . 8 . . 4 . . . . . . 
    . . . . . 8 . . . . 4 . . . . . 
    . . . . . 8 . . . . 4 . . . . . 
    . . . . 8 . . . . . . 4 . . . . 
    . . . . 8 . . . . . . 4 . . . . 
    . . . . . 8 . . . . 4 . . . . . 
    . . . . . 8 . . . . 4 . . . . . 
    . . . . . . 8 . . 4 . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `, SpriteKind.screenThing)
let portalGun = sprites.create(img`
    ................................................................dffd...........................................................................................
    ...............................................................dffffcd.........................................................................................
    ...............................................................cffffffb........................................................................................
    ..............................................................cffffffb.........................................................................................
    .............................................................bffffff...........................................................................................
    .............................................................ffffcfffd.........................................................................................
    ............................................................cfffc.dfffc........................................................................................
    ...........................................................bffcd...dffffd.d....................................................................................
    ..........................................................dffc......bffffcfd...................................................................................
    ..........................................................cff........cfffffb...................................................................................
    ..........................................................dfd.........bfffffc..................................................................................
    .......................................................................cfffffd.................................................................................
    ........................................................................cffffb.................................................................................
    ........................................................................cfffc.......d..........................................................................
    ........................................................................cffdd...dcffffd........................................................................
    ........................................................................cff....dfffffcf........................................................................
    ........................................................................fff...dfffd..ffc.......................................................................
    .......................................................................dfff...fff....cff.......................................................................
    .......................................................................bfff..cff.....bcf.......................................................................
    .......................................................................cffc..cfd.....bff.......................................................................
    .......................................................................cffc..ff......bff.......................................................................
    .......................................................................cffc..ff......cff.......................................................................
    .......................................................................ffffd.ff......cff.......................................................................
    .......................................................................fffcccff......cff.......................................................................
    ....................................................................dccfffcffff......fff.......................................................................
    .....................................................................bfffffcfffc.....ffc.......................................................................
    ......................................................................cfffcffffcc...dffb.......................................................................
    ......................................................................ffffcfffcdcc..dffd.......................................................................
    .....................................................................cfbcbffffd.....dffd.......................................................................
    ................................................bbbbbd...............fc.cffffc......dffd.......................................................................
    ............................................dbccfffffffcbdd.......bdcfbccffbf.......dff........................................................................
    ..........................................dcffffffffffffffffccbd.cfffffcffffb.......bff........................................................................
    .........................................bffffffffffffffffffffffcffffffcfffc........bff........................................................................
    ........................................cfffffffffffffffffffffffffffffcfffffb.......bff........................................................................
    ......................................dccffffffffffffffffffffffffffffffffffdc.......dffb.......................................................................
    .....................................dccfffffffffffffffffffffffffffffffffffd........dffc.......................................................................
    .....................................ccfffffffffffffffcfffffffffffffffffffc..........fff.......................................................................
    ....................................bfffffffffffffcffffffffffffffffffffffb...........cff.......................................................................
    ....................................cffffffffffffcfffffffffffffffffffffffb...........bcfd......................................................................
    ...................................bcffffffffffcffffffffffffffffffffffffffb..........dfff......................................................................
    ...................................cfffffffffffffffffccffffffffffffffffffffb..........bffb.....................................................................
    ...................................cffffffffffffffffcccfcfffffffffffffffffffd..........fff.....................................................................
    ..................................bfffffffffccfffffcccccfffffffffffffffffffff..........bffb....................................................................
    ..................................cfffffffffcfffffcccccccffffffffffffffffffffc..........fffd...................................................................
    ..................................cffffffffcffcfffccccffffffffffffffffffffffffd.........dffc...................................................................
    ..................................cffffffffffffffffcccffffffffffffffffffffffffc..........fffb..................................................................
    ..................................cfffffffffffffcffcfffffffffffffffffffffffffffb..........fffd.................................................................
    ..................................cffffffccccfffffcffffffffcffffffffffffffffffffb..........fffd................................................................
    ..................................cffffffcfcfffffcffffffcfffcccccccccfffffffffffcd.........bfff................................................................
    ..................................bfffffccfccfcccfffffffffcccccccccccccfffffffffcc..........cffc...............................................................
    ..................................dbbfffcfffccfccfffffcfccccccccccccccccffffffffccb..........fffc..............................................................
    ..................................ddbbffcffcccccfffffcfccccccccccccccccccfffffffccc...........ffffd............................................................
    .................................dddbbbfcffccccfffffffccccccccccccccccccccfffffffccb..........dffffc.....bbbbbd................................................
    .................................ddddbbccffccccffffffccccccccccccccccccccccffffffcbbbddddd.....dcffffb..bbbbbbbb...............................................
    ................................dddddbbbcffccccffffcfcccccccccccccccccccccccccbbbbbcbbbbbbbbbbdd.bffffcbbbbbbbbbbd.............................................
    ................................dddddbbbccffccffffcfccccccccccccccccccccccbbbbbbbbbbbbccbbbbbbbbbbbcffcbbbbbbbbbbbbd...........................................
    ................................ddddddbbbccfccffffdfccccccccccccccccccccbbbbbbbbbbbbbbbbccbbbbbbbbbbbbbbbbbbbbbbbbbbd..........................................
    ................................ddddddbbbccffcffff.fbcccccccccccccccccbddbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbcd.........................................
    ...............................dddddddbbbccccffffcbcbcccccccccccccccbddddbbbbbbbbbbbbbbbbbbbccbbbbbbbbbbbbbbbbbbbbbbbcd........................................
    ...............................ddddddddbbccccffffccccccccccccccccccbddddddbbbbbbbbbbbbbbbbbbbbccbbbbbbbbbbbbbbbbbbbbbbb........................................
    ...............................ddddddddbbccfcffffffcccccccccccccccdddddddddbbbbbbbbbbbbbbbbbbbbbccbbbbbbbbbbbbbbbbbbbbcb.......................................
    ...............................ddddddddbbccffffffffcccccccccccccbddddddddddbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbcd......................................
    ..............................dddddddddbbcfffffffffccccccccccccbddddddddddddbbbbbbbbbbbbbbbbbbbbbbcfbbbbbbbbbbbbbbbbbbbcb......................................
    ..............................dddddddddbbcfffffffffccccccccccccddddddddddddddddbbbbbbbbbbbbbbbbcccbccbccccbbbbbbbbbbbbbbbd.....................................
    .......dc.....................dddddddddbbcffffffffffccccccccccdddddddddddddddddddbbbbbbbbbbbbbccccccfffffffcccbbbbbbbbbbbbbd...................................
    ......dfff....................dddddddddbbcffffffffffcccccccccdddddddddddddddddddddbbbbbbbbbbdcccffffffffffcccccccbbbbbbbbbbbbd.................................
    ......cffd....................dddddddddbbcfffffffffffcccccccddddddddddddddddddddddbbbbbbbbbbbcccfffffffffffcccccccbbbbbbbbbbbbbd...............................
    .....cffd.....................dddddddddbccfffffffffffccccccbdddddddddddddddddddddddbbbbbbbbbbbcfffffffffffffffcccccbbbbbbbbbbbbbbd.............................
    ....cffd.....................ddddddddddbbcffffffffffffccccbddddddddddddddddddddddddbbbbbbbbbbbbcffffcccccffcffffffbbbbbbbbbbbbbbbbbd...........................
    ...cfff......................ddddddddddbbcfffffffffffffcccddddddddddddddddddddddddddbbbbbbbbbbbbbbccfffffffffcfccbbbbbbbbbbbbbbbbbbbbd.........................
    ..cfffb......................ddddddddddbcccfffffffffffffcbddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbcbdbbbbbbbbbbbbbbbbbbbbbbbd.......................
    .cffff.......................ddddddddddbcccfffffcfffffffcdddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbccbbbbbbbbbbbbbbbbbbbbbbbbcd.....................
    cffffc.......................ddddddddddbcccfffffffffffffddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbccbbbbbbbbbbbbbbbbbbbbbbbbbcd...................
    fffff.......................dddddddddddbcccffffffcfffffbddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbcfbbbbbbbbbbbbbbbbbbbbbbbbbbb..................
    fffff....................bfffbdddddddddccccffcfffffffffdddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbcb................
    fffffb...................cfffcdddddddddccccffccfffffffbddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbbc...............
    ffffffd..................dffffddddddddbcccccffcfffffffdddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbbcb.............
    dffdfff.d................bffffddddddddbcccccfffcfffffcddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbbbbd...........
    .bc.bffc............d...cfffffddddddddbcccccfffccffffddddddddddddddddddddddddddddddddbdddbbbbbbbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbbbbb..........
    ....dfffd...........fcdffcffffbdddddddbcccccfffcfffccddddddddddddddddddddddddddddddddbbddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbbbcbd........
    .....cfff.........dcffffcdffffcdddddddbcccccfffcccffdddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb.......
    .....dffff....dccfffffffcfffbffdddddddbccccccfffffffdddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcd.....
    ......cfffcccffffffffffffffffffdddddddbccccccffffffcdddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbcfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcb....
    ......dfffffffffcfffffffffffffcddddddddccccccffffcccdddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbd..
    .......cffffffffcccbdcffffcdfc.ddddddddccccccffffffbdddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcbd
    ......bfffffcd....b.bfffffbfcf..dddddddcccccccfffffdddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbccbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbd
    .........cfc.......cfffffcf..cd.dddddddbccccccfffffddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbd
    ..........d........cffffff.......dddbddbccccccfffffdddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbd
    ..................bfffffc........ddccbdbcccccccfffcddddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbbd
    .................bfffcfc.........ddcccdbcccccccfffbddddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcfcbbbbbbbbbbbbbbbbbbbbbbbbbbbbd
    ................bffc..bb..........dbbcbdcccccccfffdddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbcfbbbbbbbbbbbbbbbbbbbbbbbbbbbbd
    ...............bffc....c..........dcbbcdccccccccffdddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbfcbbbbbbbbbbbbbbbbbbbbbbbbbbbd
    ...............ffc.....dd..........bbdcbbcccccccffdddddddddddddddddddddddddddddddddddddddddddddddbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbfcbbbbbbbbbbbbbbbbbbbbbbbbbbd
    `, SpriteKind.screenThing)
portalGun.setFlag(SpriteFlag.RelativeToCamera, true)
portalGun.setPosition(146, 80)
portalPoint.setFlag(SpriteFlag.RelativeToCamera, true)
portalPoint.setPosition(80, 59)
forever(function () {
    if (FLAG1 == true) {
        if (TESTCHAMBER == 1) {
            tiles.setTileAt(tiles.getTileLocation(0, 8), assets.tile`myTile6`)
        }
    }
    if (energyPellet2.tileKindAt(TileDirection.Center, assets.tile`myTile2`)) {
        energyPellet2.setFlag(SpriteFlag.GhostThroughWalls, true)
    } else {
        energyPellet2.setFlag(SpriteFlag.GhostThroughWalls, false)
    }
    if (mySprite.tileKindAt(TileDirection.Center, assets.tile`myTile0`)) {
        if (lastPortal == 1) {
            if (newBluePortalX > blueSpawnX || newBluePortalX < blueSpawnX) {
                mySprite.x = bluePortal2.x + 0
                mySprite.y = bluePortal2.y + 10
                if (!(controller.down.isPressed())) {
                    Render.setViewAngleInDegree(90)
                } else {
                    Render.setViewAngleInDegree(270)
                }
            } else if (newBluePortalY > blueSpwanY || newBluePortalY < blueSpwanY) {
                mySprite.x = bluePortal2.x + 10
                mySprite.y = bluePortal2.y + 0
                if (!(controller.down.isPressed())) {
                    Render.setViewAngleInDegree(0)
                } else {
                    Render.setViewAngleInDegree(180)
                }
            }
        } else if (lastPortal == 2) {
            if (newOrangePortalX > orangeSpawnX || newOrangePortalX < orangeSpawnX) {
                mySprite.x = orangePortal2.x + 0
                mySprite.y = orangePortal2.y + 10
                if (!(controller.down.isPressed())) {
                    Render.setViewAngleInDegree(90)
                } else {
                    Render.setViewAngleInDegree(270)
                }
            } else if (newOrangePortalY > orangeSpawnY || newOrangePortalY < orangeSpawnY) {
                mySprite.x = orangePortal2.x + 10
                mySprite.y = orangePortal2.y + 0
                if (!(controller.down.isPressed())) {
                    Render.setViewAngleInDegree(0)
                } else {
                    Render.setViewAngleInDegree(180)
                }
            }
        }
    }
    if (energyPellet2.lifespan == 0) {
        pause(1000)
        EnergyPellet(0, -100)
    }
    if (doorWatch == true) {
        if (mySprite.tileKindAt(TileDirection.Center, assets.tile`myTile6`)) {
        	
        } else {
            tiles.setWallAt(tiles.getTileLocation(0, 0), true)
        }
    }
})
